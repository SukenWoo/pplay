{"version":3,"sources":["webpack:///./src/bus.js","webpack:///./src/util/shaders/complex.glsl","webpack:///../query-state/lib/windowHistory.js","webpack:///../query-state/lib/inMemoryHistory.js","webpack:///../query-state/index.js","webpack:///./src/util/gl-utils.js","webpack:///./src/appState.js","webpack:///../query-state/lib/query.js","webpack:///./src/util/shaders/getFragmentCode.js","webpack:///./src/channels/audioInput.js","webpack:///./src/util/loadImage.js","webpack:///./src/util/request.js","webpack:///./src/channels/loadSoundCloudStream.js","webpack:///./src/editor/getParsedShaderFunction.js","webpack:///./src/util/shaders/main.glsl","webpack:///./src/editor/shaderCodeState.js","webpack:///./src/channels/isSoundCloud.js","webpack:///./src/scene.js","webpack:///./src/util/shaders/bezier.glsl","webpack:///./src/channelsState.js","webpack:///./src/util/isSmallScreen.js","webpack:///../query-state/node_modules/ngraph.events/index.js","webpack:///./src/editor/pragmaParser.js","webpack:///./src/util/loadGist.js","webpack:///./src/util/createShaders.js","webpack:///./src/editor/fetchGLSL.js","webpack:///./src/nativeMain.js","webpack:///./src/channels/binHistory.js"],"names":["eventify","__webpack_require__","module","exports","defaults","options","window","inMemoryHistory","listeners","useSearchPart","useSearch","hashPrefix","rewriteHashToSearch","stateFromHash","getStateFromHash","stateChanged","Object","keys","forEach","key","set","onChanged","changeCallback","Error","length","addEventListener","onHashChanged","push","dispose","removeEventListener","get","mergedState","create","searchString","location","search","assign","query","parse","substr","hashString","hash","appState","stringify","history","replaceState","undefined","replace","i","listener","notifyListeners","baseString","queryString","lastQueryObject","newQueryObject","setTimeout","queryState","singletonQS","windowHistory","validateHistoryAPI","newAppState","eventBus","fire","api","keyName","value","keyNameType","unset","setIfEmpty","off","onChange","callback","ctx","on","offChange","getHistoryObject","instance","createShader","gl","type","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","bindTexture","texture","unit","activeTexture","TEXTURE0","TEXTURE_2D","createBuffer","data","buffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","bindAttribute","attribute","numComponents","enableVertexAttribArray","vertexAttribPointer","FLOAT","createProgram","vertexSource","fragmentSource","program","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","wrapper","unload","deleteProgram","numAttributes","ACTIVE_ATTRIBUTES","getActiveAttrib","name","getAttribLocation","numUniforms","ACTIVE_UNIFORMS","uniform","getActiveUniform","getUniformLocation","createTexture","image","internalFormat","RGBA","srcFormat","srcType","UNSIGNED_BYTE","texImage2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","appStateReady","pendingSaveCallback","bus","isSmallScreen","loadGist","qs","defaultCode","currentCode","protoGist","then","code","ready","settingsPanel","collapsed","isSettingsPanelCollapsedInitially","catch","err","console","error","loadError","codeLimitError","audioWarning","hideUI","saveCode","fc","hasCode","getCode","getDefaultCode","saveTransform","tx","ty","scale","clearTimeout","getVisibleRectangle","sceneWidth","sceneHeight","Number","isFinite","left","top","right","bottom","addChannel","src","removeChannel","getActiveChannels","active","setSoundIOSWarning","isActive","isIOS","test","navigator","userAgent","MSStream","scene","encodePart","part","encodeURIComponent","saferEscape","character","split","queryRecord","str","strValue","pair","decodeURIComponent","isNaN","match","Date","parseFloat","object","map","toISOString","encodeValue","join","complexLibrary","bezier","main","isSoundCloud","loadSoundCloudStream","audioTexture","player","analyser","audioData","streamUrl","fftSize","channelName","resName","frequencyData","Uint8Array","height","width","freeze","kind","load","url","playerEl","document","querySelector","createElement","preload","autobuffer","constrols","style","visibility","body","appendChild","initPlayer","deleteTexture","render","frameNumber","getByteFrequencyData","max","prevPosition","currentPosition","ci","previ","immediateValue","avgValue","longAvg","prevAgg","currentAgg","p","aggOffset","pAggOffset","aggAvgValue","aggLongAvg","halfMax","uniform1i","uniform2f","currentTime","duration","crossOrigin","autoplay","audioCtx","AudioContext","webkitAudioContext","createAnalyser","createMediaElementSource","connect","destination","filter","TEXTURE_MAG_FILTER","setAttribute","play","onPlayerEnded","onPlayerStarted","resolveImage","rejectImage","Image","onload","onerror","Promise","resolve","reject","req","XMLHttpRequest","progress","e","lengthComputable","loaded","total","percent","status","response","responseType","JSON","open","send","track_url","SC","scAPI","head","successCallback","errorCallback","initialize","client_id","sound","errors","errorMessage","error_message","tracks","stream_url","pragmaParse","getFragmentCode","glslParser","check","log","errorCount","whitespace","Array","bind","oe","shaderCode","libAndCode","pragmaParseResult","parsedCode","parserResult","diag","diagnostics","firstError","range","lineColumn","offset","_lineOffsets","line","contents","column","substring","start","end","prefix","diagText","text","errorDetail","isFloatError","indexOf","parserError","getParsedShaderFunction","updateCode","parseCode","persistedCode","currentShaderVersion","currentShaderCode","trySetNewCode","result","setCode","cancelled","updateErrorInfo","customCode","currentResult","capturedVersion","message","makePanzoom","createShaderCodeState","util","createShaders","createChannelsState","HIDE_UI_THRESHOLD","canvas","startTime","getContext","cursor","currentX","currentY","clickX","clickY","currentFrameNumber","orientation","alpha","beta","gamma","absolute","sceneTransform","x","y","z","clientWidth","clientHeight","panzoom","controller","applyTransform","getOwner","restorePanzoom","nextAnimationFrame","lastActiveIntervalId","requestSizeUpdate","requestTransformUpdate","orientationChanged","lastActivityTime","updateSize","onMouseMove","onMouseClick","onTouchStart","onTouchMove","activate","onOrientationChange","setActivityMonitorEnabled","screenProgram","quadBuffer","enable","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","clearColor","channelsState","state","codeEditorState","updateProgram","performance","now","Float32Array","a_pos","scheduleNextFrame","goToOrigin","showRectangle","innerWidth","innerHeight","getTransform","cancelAnimationFrame","animate","clear","DEPTH_BUFFER_BIT","COLOR_BUFFER_BIT","useProgram","viewport","iResolution","uniform3f","iTransform","iTime","uniform1f","iFrame","uniform4f","iMouse","iOrientation","drawArrays","TRIANGLES","drawCurrentFrame","requestAnimationFrame","newTransform","rect","markInactiveIfNeeded","enabled","setInterval","clearInterval","firstTouch","touches","setClick","clientX","clientY","setHover","Math","PI","ex","ey","loadImage","glUtils","audioInput","getIndexOfModelWithUnit","arr","modelUnit","takenUnits","Set","MAX_UNITS_COUNT","viewModels","models","list","channel","has","modelIndex","splice","viewModelIndex","delete","hasAudio","m","activeChannels","channelInfo","restoreState","getAvailableUnit","input","needsBinding","imageInput","add","inputViewModel","model","subject","reservedWords","hasOwnProperty","validateSubject","eventsStorage","registeredEvents","eventName","handlers","wantToRemoveAll","deleteAllCallbacksForEvent","callbacks","fireArguments","arguments","prototype","call","callbackInfo","apply","createEventsStorage","fetchGLSL","pragmaInclude","defineInclude","nullCode","parsedLines","pending","lines","outputLines","currentIndex","substitutes","Map","index","include","insertIndex","matches","processPragma","size","replacement","RegExp","replaceDefines","processLineByLine","all","request","extractFileContent","res","parts","parsedRes","fileName","files","file","content","loadedLinks","link","trimmed","trim","cachedResponse","initScene","getElementById","launch","ctxOptions","antialias","webGLEnabled","initPixelPlay","historySize","min","POSITIVE_INFINITY","NEGATIVE_INFINITY","lastIndex","needsReindex","addSample","getFrequencyRatio","currentValue","v","reIndex"],"mappings":"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","file":"static/js/app.e2127664b6fa71a3575e.js","sourcesContent":["/**\n * This is a simple way to pass messages between application components.\n */\nvar eventify = require('ngraph.events');\n\nmodule.exports = eventify({});\n\n\n// WEBPACK FOOTER //\n// ./src/bus.js","module.exports = \"// based on https://github.com/rust-num/num-complex/blob/master/src/lib.rs\\n// Copyright 2013 The Rust Project Developers. MIT license\\n// Ported to GLSL by Andrei Kashcha (github.com/anvaka), available under MIT license as well.\\nfloat cosh(float val) {\\n  float tmp = exp(val);\\n  return (tmp + 1.0 / tmp) / 2.0;\\n}\\n \\nfloat tanh(float val) {\\n  float tmp = exp(val);\\n  return (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\\n}\\n \\nfloat sinh(float val) {\\n  float tmp = exp(val);\\n  return (tmp - 1.0 / tmp) / 2.0;\\n}\\n\\nvec2 cosh(vec2 val) {\\n  vec2 tmp = exp(val);\\n  return(tmp + 1.0 / tmp) / 2.0;\\n}\\n \\nvec2 tanh(vec2 val) {\\n  vec2 tmp = exp(val);\\n  return (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\\n}\\n \\nvec2 sinh(vec2 val) {\\n  vec2 tmp = exp(val);\\n  return (tmp - 1.0 / tmp) / 2.0;\\n}\\n\\nvec2 c_one() { return vec2(1., 0.); }\\nvec2 c_i() { return vec2(0., 1.); }\\n\\nfloat arg(vec2 c) {\\n  return atan(c.y, c.x);\\n}\\n\\nvec2 c_conj(vec2 c) {\\n  return vec2(c.x, -c.y);\\n}\\n\\nvec2 c_from_polar(float r, float theta) {\\n  return vec2(r * cos(theta), r * sin(theta));\\n}\\n\\nvec2 c_to_polar(vec2 c) {\\n  return vec2(length(c), atan(c.y, c.x));\\n}\\n\\n/// Computes `e^(c)`, where `e` is the base of the natural logarithm.\\nvec2 c_exp(vec2 c) {\\n  return c_from_polar(exp(c.x), c.y);\\n}\\n\\n\\n/// Raises a floating point number to the complex power `c`.\\nvec2 c_exp(float base, vec2 c) {\\n  return c_from_polar(pow(base, c.x), c.y * log(base));\\n}\\n\\n/// Computes the principal value of natural logarithm of `c`.\\nvec2 c_ln(vec2 c) {\\n  vec2 polar = c_to_polar(c);\\n  return vec2(log(polar.x), polar.y);\\n}\\n\\n/// Returns the logarithm of `c` with respect to an arbitrary base.\\nvec2 c_log(vec2 c, float base) {\\n  vec2 polar = c_to_polar(c);\\n  return vec2(log(polar.r), polar.y) / log(base);\\n}\\n\\nvec2 c_sqrt(vec2 c) {\\n  vec2 p = c_to_polar(c);\\n  return c_from_polar(sqrt(p.x), p.y/2.);\\n}\\n\\n/// Raises `c` to a floating point power `e`.\\nvec2 c_pow(vec2 c, float e) {\\n  vec2 p = c_to_polar(c);\\n  return c_from_polar(pow(p.x, e), p.y*e);\\n}\\n\\n/// Raises `c` to a complex power `e`.\\nvec2 c_pow(vec2 c, vec2 e) {\\n  vec2 polar = c_to_polar(c);\\n  return c_from_polar(\\n     pow(polar.x, e.x) * exp(-e.y * polar.y),\\n     e.x * polar.y + e.y * log(polar.x)\\n  );\\n}\\n\\nvec2 c_mul(vec2 self, vec2 other) {\\n    return vec2(self.x * other.x - self.y * other.y, \\n                self.x * other.y + self.y * other.x);\\n}\\n\\nvec2 c_div(vec2 self, vec2 other) {\\n    float norm = length(other);\\n    return vec2(self.x * other.x + self.y * other.y,\\n                self.y * other.x - self.x * other.y)/(norm * norm);\\n}\\n\\nvec2 c_sin(vec2 c) {\\n  return vec2(sin(c.x) * cosh(c.y), cos(c.x) * sinh(c.y));\\n}\\n\\nvec2 c_cos(vec2 c) {\\n  // formula: cos(a + bi) = cos(a)cosh(b) - i*sin(a)sinh(b)\\n  return vec2(cos(c.x) * cosh(c.y), -sin(c.x) * sinh(c.y));\\n}\\n\\nvec2 c_tan(vec2 c) {\\n  vec2 c2 = 2. * c;\\n  return vec2(sin(c2.x), sinh(c2.y))/(cos(c2.x) + cosh(c2.y));\\n}\\n\\nvec2 c_atan(vec2 c) {\\n  // formula: arctan(z) = (ln(1+iz) - ln(1-iz))/(2i)\\n  vec2 i = c_i();\\n  vec2 one = c_one();\\n  vec2 two = one + one;\\n  if (c == i) {\\n    return vec2(0., 1./0.0);\\n  } else if (c == -i) {\\n    return vec2(0., -1./0.0);\\n  }\\n\\n  return c_div(\\n    c_ln(one + c_mul(i, c)) - c_ln(one - c_mul(i, c)),\\n    c_mul(two, i)\\n  );\\n}\\n\\nvec2 c_asin(vec2 c) {\\n // formula: arcsin(z) = -i ln(sqrt(1-z^2) + iz)\\n  vec2 i = c_i(); vec2 one = c_one();\\n  return c_mul(-i, c_ln(\\n    c_sqrt(c_one() - c_mul(c, c)) + c_mul(i, c)\\n  ));\\n}\\n\\nvec2 c_acos(vec2 c) {\\n  // formula: arccos(z) = -i ln(i sqrt(1-z^2) + z)\\n  vec2 i = c_i();\\n\\n  return c_mul(-i, c_ln(\\n    c_mul(i, c_sqrt(c_one() - c_mul(c, c))) + c\\n  ));\\n}\\n\\nvec2 c_sinh(vec2 c) {\\n  return vec2(sinh(c.x) * cos(c.y), cosh(c.x) * sin(c.y));\\n}\\n\\nvec2 c_cosh(vec2 c) {\\n  return vec2(cosh(c.x) * cos(c.y), sinh(c.x) * sin(c.y));\\n}\\n\\nvec2 c_tanh(vec2 c) {\\n  vec2 c2 = 2. * c;\\n  return vec2(sinh(c2.x), sin(c2.y))/(cosh(c2.x) + cos(c2.y));\\n}\\n\\nvec2 c_asinh(vec2 c) {\\n  // formula: arcsinh(z) = ln(z + sqrt(1+z^2))\\n  vec2 one = c_one();\\n  return c_ln(c + c_sqrt(one + c_mul(c, c)));\\n}\\n\\nvec2 c_acosh(vec2 c) {\\n  // formula: arccosh(z) = 2 ln(sqrt((z+1)/2) + sqrt((z-1)/2))\\n  vec2 one = c_one();\\n  vec2 two = one + one;\\n  return c_mul(two,\\n      c_ln(\\n        c_sqrt(c_div((c + one), two)) + c_sqrt(c_div((c - one), two))\\n      ));\\n}\\n\\nvec2 c_atanh(vec2 c) {\\n  // formula: arctanh(z) = (ln(1+z) - ln(1-z))/2\\n  vec2 one = c_one();\\n  vec2 two = one + one;\\n  if (c == one) {\\n      return vec2(1./0., vec2(0.));\\n  } else if (c == -one) {\\n      return vec2(-1./0., vec2(0.));\\n  }\\n  return c_div(c_ln(one + c) - c_ln(one - c), two);\\n}\\n\\n// Attempts to identify the gaussian integer whose product with `modulus`\\n// is closest to `c`\\nvec2 c_rem(vec2 c, vec2 modulus) {\\n  vec2 c0 = c_div(c, modulus);\\n  // This is the gaussian integer corresponding to the true ratio\\n  // rounded towards zero.\\n  vec2 c1 = vec2(c0.x - mod(c0.x, 1.), c0.y - mod(c0.y, 1.));\\n  return c - c_mul(modulus, c1);\\n}\\n\\nvec2 c_inv(vec2 c) {\\n  float norm = length(c);\\n\\treturn vec2(c.x, -c.y) / (norm * norm);\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/util/shaders/complex.glsl\n// module id = 26+/\n// module chunks = 2","/**\n * Uses `window` to monitor hash and update hash\n */\nmodule.exports = windowHistory;\n\nvar inMemoryHistory = require('./inMemoryHistory.js');\nvar query = require('./query.js');\n\nfunction windowHistory(defaults, options) {\n  // If we don't support window, we are probably running in node. Just return\n  // in memory history\n  if (typeof window === 'undefined') return inMemoryHistory(defaults);\n\n  // Store all `onChanged()` listeners here, so that we can have just one\n  // `hashchange` listener, and notify one listeners within single event.\n  var listeners = [];\n\n  var useSearchPart = options && options.useSearch; // prefer query ? over hash #\n\n  // This prefix is used for all query strings. So our state is stored as\n  // my-app.com/#?key=value\n  var hashPrefix = useSearchPart ? '?' : '#?';\n\n  if (options.rewriteHashToSearch) {\n    rewriteHashToSearch();\n  }\n  init();\n\n  // This is our public API:\n  return {\n    /**\n     * Adds callback that is called when hash change happen. Callback receives\n     * current hash string with `#?` sign\n     * \n     * @param {Function} changeCallback - a function that is called when hash is\n     * changed. Callback gets one argument that represents the new state.\n     */\n    onChanged: onChanged,\n\n    /**\n     * Releases all resources\n     */\n    dispose: dispose,\n\n    /**\n     * Sets a new app state\n     *\n     * @param {object} appState - the new application state, that should be\n     * persisted in the hash string\n     */\n    set: set,\n\n    /**\n     * Gets current app state\n     */\n    get: getStateFromHash,\n\n    /**\n     * Allows to rewrite current hash url into search url\n     */\n    rewriteHashToSearch: rewriteHashToSearch\n  };\n\n  // Public API is over. You can ignore this part.\n\n  function init() {\n    var stateFromHash = getStateFromHash();\n    var stateChanged = false;\n\n    if (typeof defaults === 'object' && defaults) {\n      Object.keys(defaults).forEach(function(key) {\n        if (key in stateFromHash) return;\n\n        stateFromHash[key] = defaults[key]\n        stateChanged = true;\n      });\n    }\n\n    if (stateChanged) set(stateFromHash);\n  }\n\n  function rewriteHashToSearch() {\n    var mergedState = Object.create(null);\n\n    var searchString = window.location.search;\n    if (searchString) mergedState = Object.assign(mergedState, query.parse(searchString.substr(1)));\n\n    var hashString = window.location.hash;\n    if (hashString) mergedState = Object.assign(mergedState, query.parse(hashString.substr(2)));\n\n    set(mergedState);\n  }\n\n  function set(appState) {\n    var hash = hashPrefix + query.stringify(appState);\n    if (useSearchPart && window.location.hash) {\n      // preserve hash if it was there.\n      hash += window.location.hash;\n    }\n\n    if (window.history) {\n      window.history.replaceState(undefined, undefined, hash);\n    } else {\n      window.location.replace(hash);\n    }\n  }\n\n  function onChanged(changeCallback) {\n    if (typeof changeCallback !== 'function') throw new Error('changeCallback needs to be a function');\n\n    // we start listen just once, only if we didn't listen before:\n    if (listeners.length === 0) {\n      window.addEventListener('hashchange', onHashChanged, false);\n    }\n\n    listeners.push(changeCallback);\n  }\n\n  function dispose() {\n    if (listeners.length === 0) return; // no need to do anything.\n\n    // Let garbage collector collect all listeners;\n    listeners = [];\n\n    // And release hash change event:\n    window.removeEventListener('hashchange', onHashChanged, false);\n  }\n\n  function onHashChanged() {\n    var appState = getStateFromHash();\n    notifyListeners(appState);\n  }\n\n  function notifyListeners(appState) {\n    for (var i = 0; i < listeners.length; ++i) {\n      var listener = listeners[i];\n      listener(appState);\n    }\n  }\n\n  function getStateFromHash() {\n    var baseString = useSearchPart ? window.location.search : window.location.hash;\n    // or symbol || is used to get empty string when no base string is present. \n    var queryString = (baseString || hashPrefix).substr(hashPrefix.length);\n    return query.parse(queryString);\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../query-state/lib/windowHistory.js\n// module id = 2PgA\n// module chunks = 2","/**\n * Provides a `null` object that matches history API\n */\nmodule.exports = inMemoryHistory;\n\nfunction inMemoryHistory(defaults) {\n  var listeners = [];\n  var lastQueryObject = defaults;\n\n  return {\n    dispose: dispose,\n    onChanged: onChanged,\n    set: set,\n    get: get\n  };\n\n  function get() {\n    return lastQueryObject;\n  }\n\n  function set(newQueryObject) {\n    lastQueryObject = newQueryObject;\n    setTimeout(function() {\n      triggerChange(newQueryObject);\n    }, 0);\n  }\n\n  function dispose() {\n    listeners = [];\n  }\n\n  function onChanged(changeCallback) {\n    if (typeof changeCallback !== 'function') {\n      throw new Error('changeCallback should be a function')\n    }\n\n    listeners.push(changeCallback);\n  }\n\n  function triggerChange(appState) {\n    listeners.forEach(function(listener) {\n      listener(appState);\n    });\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../query-state/lib/inMemoryHistory.js\n// module id = 5hi0\n// module chunks = 2","/**\n * Allows application to access and update current app state via query string\n */\nmodule.exports = queryState;\n\nvar eventify = require('ngraph.events');\nvar windowHistory = require('./lib/windowHistory.js');\n\n/**\n * Just a convenience function that returns singleton instance of a query state\n */\nqueryState.instance = instance;\n\n// this variable holds singleton instance of the query state\nvar singletonQS;\n\n/**\n * Creates new instance of the query state.\n */\nfunction queryState(defaults, options) {\n  options = options || {};\n  var history = options.history || windowHistory(defaults, options);\n  validateHistoryAPI(history);\n\n  history.onChanged(updateQuery)\n\n  var query = history.get() || Object.create(null);\n\n  var api = {\n\n    /**\n     * Gets current state.\n     *\n     * @param {string?} keyName if present then value for this key is returned.\n     * Otherwise the entire app state is returned.\n     */\n    get: getValue,\n\n    /**\n     * Merges current app state with new key/value.\n     *\n     * @param {string} key name\n     * @param {string|number|date} value\n     */\n    set: setValue,\n\n    /**\n     * Removes value from the query string\n     */\n    unset: unsetValue,\n\n    /**\n     * Similar to `set()`, but only sets value if it was not set before.\n     *\n     * @param {string} key name\n     * @param {string|number|date} value\n     */\n    setIfEmpty: setIfEmpty,\n\n    /**\n     * Releases all resources acquired by query state. After calling this method\n     * no hash monitoring will happen and no more events will be fired.\n     */\n    dispose: dispose,\n\n    onChange: onChange,\n    offChange: offChange,\n\n    getHistoryObject: getHistoryObject,\n  }\n\n  var eventBus = eventify({});\n\n  return api;\n\n  function onChange(callback, ctx) {\n    eventBus.on('change', callback, ctx);\n  }\n\n  function offChange(callback, ctx) {\n    eventBus.off('change', callback, ctx)\n  }\n\n  function getHistoryObject() {\n    return history;\n  }\n\n  function dispose() {\n    // dispose all history listeners\n    history.dispose();\n\n    // And remove our own listeners\n    eventBus.off();\n  }\n\n  function getValue(keyName) {\n    if (keyName === undefined) return query;\n\n    return query[keyName];\n  }\n\n  function setValue(keyName, value) {\n    var keyNameType = typeof keyName;\n\n    if (keyNameType === 'object') {\n      Object.keys(keyName).forEach(function(key) {\n        query[key] = keyName[key];\n      });\n    } else if (keyNameType === 'string') {\n      query[keyName] = value;\n    }\n\n    history.set(query);\n\n    return api;\n  }\n\n  function unsetValue(keyName) {\n    if (!(keyName in query)) return; // nothing to do\n\n    delete query[keyName];\n    history.set(query);\n\n    return api;\n  }\n\n  function updateQuery(newAppState) {\n    query = newAppState;\n    eventBus.fire('change', query);\n  }\n\n  function setIfEmpty(keyName, value) {\n    if (typeof keyName === 'object') {\n      Object.keys(keyName).forEach(function(key) {\n        // TODO: Can I remove code duplication? The main reason why I don't\n        // want recursion here is to avoid spamming `history.set()`\n        if (key in query) return; // key name is not empty\n\n        query[key] = keyName[key];\n      });\n    }\n\n    if (keyName in query) return; // key name is not empty\n    query[keyName] = value;\n\n    history.set(query);\n\n    return api;\n  }\n}\n\n/**\n * Returns singleton instance of the query state.\n *\n * @param {Object} defaults - if present, then it is passed to the current instance\n * of the query state. Defaults are applied only if they were not present before.\n */\nfunction instance(defaults, options) {\n  if (!singletonQS) {\n    singletonQS = queryState(defaults, options);\n  } else if (defaults) {\n    singletonQS.setIfEmpty(defaults);\n  }\n\n  return singletonQS;\n}\n\nfunction validateHistoryAPI(history) {\n  if (!history) throw new Error('history is required');\n  if (typeof history.dispose !== 'function') throw new Error('dispose is required');\n  if (typeof history.onChanged !== 'function') throw new Error('onChanged is required');\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../query-state/index.js\n// module id = 7UaU\n// module chunks = 2","// Based on https://github.com/mapbox/webgl-wind\n// Licensed under ISC License Copyright (c) 2016, Mapbox\n// https://github.com/mapbox/webgl-wind/blob/master/LICENSE\n\n// Adapted to my own needs here.\n\nmodule.exports = {\n  bindTexture: bindTexture,\n  createBuffer: createBuffer,\n  bindAttribute: bindAttribute,\n  createProgram: createProgram,\n  createShader: createShader,\n  createTexture: createTexture\n}\n\nfunction bindTexture(gl, texture, unit) {\n  gl.activeTexture(gl.TEXTURE0 + unit);\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n}\n\nfunction createTexture(gl, image) {\n  var texture = gl.createTexture();\n  var level = 0;\n  var internalFormat = gl.RGBA;\n  var srcFormat = gl.RGBA;\n  var srcType = gl.UNSIGNED_BYTE;\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, srcFormat, srcType, image);\n\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\n  return texture;\n}\n\nfunction createBuffer(gl, data) {\n  var buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n  return buffer;\n}\n\nfunction bindAttribute(gl, buffer, attribute, numComponents) {\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.enableVertexAttribArray(attribute);\n  gl.vertexAttribPointer(attribute, numComponents, gl.FLOAT, false, 0, 0);\n}\n\nfunction createProgram(gl, vertexSource, fragmentSource) {\n  var program = gl.createProgram();\n\n  var vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexSource);\n  var fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentSource);\n\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n\n  gl.linkProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      throw new Error(gl.getProgramInfoLog(program));\n  }\n\n  var wrapper = {\n    program: program,\n    unload: unload\n  };\n\n  var numAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n  var i;\n  for (i = 0; i < numAttributes; i++) {\n    var attribute = gl.getActiveAttrib(program, i);\n    wrapper[attribute.name] = gl.getAttribLocation(program, attribute.name);\n  }\n  var numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  for (i = 0; i < numUniforms; i++) {\n    var uniform = gl.getActiveUniform(program, i);\n    wrapper[uniform.name] = gl.getUniformLocation(program, uniform.name);\n  }\n\n  return wrapper; \n\n  function unload() {\n    gl.deleteProgram(program);\n  }\n}\n\nfunction createShader(gl, type, source) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw new Error(gl.getShaderInfoLog(shader));\n  }\n\n  return shader;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/gl-utils.js","/**\n * Okay, this file is a bit messy. Its primary responsibility\n * is to provide application state to scene and vue app. But it's\n * hard to define what application state mean in a clear way.\n * \n * For our purposes I consider anything stored in the query string to be\n * an application state\n */\nvar queryState = require('query-state');\nvar bus = require('./bus');\nvar isSmallScreen = require('./util/isSmallScreen');\nvar loadGist = require('./util/loadGist');\n\n// This will load current state from the query string.\nvar qs = queryState({}, { useSearch: true, });\n\nvar defaultCode = require('./util/shaders/main.glsl');\nvar currentCode = defaultCode; \n\nvar appStateReady;\nvar protoGist = qs.get('gist');\nif (protoGist) {\n  loadGist(protoGist).then((code) => {\n    currentCode = code;\n    appState.ready = true;\n    appState.settingsPanel.collapsed = isSettingsPanelCollapsedInitially();\n    bus.fire('appstate-ready');\n  }).catch(err => {\n    console.error(err);\n    currentCode = defaultCode; \n    appState.settingsPanel.loadError = err;\n    appState.settingsPanel.collapsed = false;\n    appState.ready = true;\n    bus.fire('appstate-ready');\n  });\n} else {\n  appStateReady = true\n\n  currentCode = qs.get('fc') || defaultCode;\n}\n\n// When user drags the scene, we don't want to immediately update the\n// query string. Some browsers would not respond well to high intensity.\n// Instead we debounce events (setTimeout, and clearTimeout if new events comes\n// before previously scheduled timeout is executed)\nvar pendingSaveCallback;\n\nvar appState = {\n  settingsPanel: {\n    // By default we will not show settings panel on small screen, or if\n    // there was a code in the query string - we just assume people want to\n    // see the result. If they are curious - they would click \"show editor\" button\n    collapsed: isSettingsPanelCollapsedInitially(),\n    codeLimitError: false,\n    loadError: null,\n    audioWarning: false,\n  },\n    // If this one is present, the no UI will ever be shown. Good for iframe embedding\n  hideUI: qs.get('hide-ui') !== undefined,\n  ready: appStateReady,\n  /**\n   * Request to save current code into query string\n   */\n  saveCode,\n\n  /**\n   * Checks whether query string has code.\n   */\n  hasCode,\n\n  /**\n   * Gets current code. Returns default code if no current code is present.\n   */\n  getCode,\n\n  /**\n   * Returns our default code\n   */\n  getDefaultCode,\n\n  /**\n   * Saves scene transform.\n   */\n  saveTransform,\n\n  /**\n   * Returns visible rectangle in screen coordinates.\n   */\n  getVisibleRectangle,\n\n  // Channel persistence\n  addChannel,\n  removeChannel,\n  getActiveChannels,\n  setSoundIOSWarning\n}\n\nvar isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n\nfunction setSoundIOSWarning(isActive) {\n  if (!isIOS) return; // Only for iOS\n  appState.settingsPanel.audioWarning = isActive;\n}\n\nfunction hasCode() {\n  return currentCode !== defaultCode;\n}\n\nfunction addChannel(unit, src) {\n  qs.set('i' + unit, src);\n}\n\nfunction removeChannel(unit) {\n  qs.unset('i' + unit);\n}\n\nfunction getActiveChannels() {\n  var active = [];\n  for(var unit = 0; unit < 3; ++unit) {\n    var src = qs.get('i' + unit);\n    if (src !== undefined) active.push({unit, src});\n  }\n\n  return active;\n}\n\nfunction saveTransform(tx, ty, scale){\n  if (pendingSaveCallback) {\n    clearTimeout(pendingSaveCallback);\n  }\n\n  pendingSaveCallback = setTimeout(() => {\n    pendingSaveCallback = 0;\n    qs.set({ tx, ty,scale });\n  }, 300);\n}\n\nfunction getVisibleRectangle(sceneWidth, sceneHeight) {\n  var tx = qs.get('tx');\n  var ty = qs.get('ty');\n  var scale = qs.get('scale');\n  if (!(Number.isFinite(tx) || Number.isFinite(ty) || Number.isFinite(scale))) return;\n\n  return ({\n    left: -tx * sceneWidth/scale,\n    top: -ty * sceneHeight/scale,\n    right: -tx * sceneWidth/scale + sceneWidth/scale,\n    bottom: -ty * sceneHeight/scale + sceneHeight/scale,\n  })\n}\n\nqs.onChange(function() {\n  // This is need to back propagate properties when query string changes.\n  bus.fire('scene-ready', window.scene);\n});\n\nfunction getCode() { return currentCode; }\n\nfunction getDefaultCode() { return defaultCode; }\n\nfunction saveCode(code) {\n  if (code.length > 1000) {\n    appState.settingsPanel.codeLimitError = true;\n    qs.unset('fc')\n  } else {\n    appState.settingsPanel.codeLimitError = false;\n    qs.set({fc: code});\n    qs.unset('gist');\n  }\n  currentCode = code;\n}\n\nfunction isSettingsPanelCollapsedInitially() {\n  return isSmallScreen() || hasCode();\n}\n\nmodule.exports = appState;\n\n\n// WEBPACK FOOTER //\n// ./src/appState.js","/**\n * This module is similar to JSON, but it encodes/decodes in query string\n * format `key1=value1...`\n */\nmodule.exports = {\n  parse: parse,\n  stringify: stringify\n};\n\nfunction stringify(object) {\n  if (!object) return '';\n\n  return Object.keys(object).map(toPairs).join('&');\n\n  function toPairs(key) {\n    var value = object[key];\n    var pair = encodePart(key);\n    if (value !== undefined) {\n      pair += '=' + encodeValue(value);\n    }\n\n    return pair;\n  }\n}\n\nfunction parse(queryString) {\n  var query = Object.create(null);\n\n  if (!queryString) return query;\n\n  queryString.split('&').forEach(decodeRecord);\n\n  return query;\n\n  function decodeRecord(queryRecord) {\n    if (!queryRecord) return;\n\n    var pair = queryRecord.split('=');\n    query[decodeURIComponent(pair[0])] = decodeValue(pair[1]);\n  }\n}\n\nfunction encodeValue(value) {\n  // TODO: Do I need this?\n  // if (typeof value === 'string') {\n  //   if (value.match(/^(true|false)$/)) {\n  //     // special handling of strings that look like booleans\n  //     value = JSON.stringify('' + value);\n  //   } else if (value.match(/^-?\\d+\\.?\\d*$/)) {\n  //     // special handling of strings that look like numbers\n  //     value = JSON.stringify('' + value);\n  //   }\n  // }\n  if (value instanceof Date) {\n    value = value.toISOString();\n  }\n  var uriValue = encodePart(value);\n  return uriValue;\n}\n\nfunction encodePart(part) {\n  // We want to make sure that we also encode symbols like ( and ) correctly\n  var encoded = encodeURIComponent(part);\n  return encoded.replace(/[()]/g, saferEscape);\n}\n\nfunction saferEscape(character) {\n  if (character === ')') return '%29';\n  if (character === '(') return '%28';\n  return character; // What?\n}\n\n/**\n * This method returns typed value from string\n */\nfunction decodeValue(value) {\n  value = decodeURIComponent(value);\n\n  if (value === \"\") return value;\n  if (!isNaN(value)) return parseFloat(value);\n  if (isBolean(value)) return value === 'true';\n  if (isISODateString(value)) return new Date(value);\n\n  return value;\n}\n\nfunction isBolean(strValue) {\n  return strValue === 'true' || strValue === 'false';\n}\n\nfunction isISODateString(str) {\n  return str && str.match(/(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))|(\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d([+-][0-2]\\d:[0-5]\\d|Z))/)\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../query-state/lib/query.js\n// module id = 9XuS\n// module chunks = 2","var complexLibrary = require('./complex.glsl');\nvar bezier = require('./bezier.glsl');\n\nmodule.exports = function getFragmentCode(main) {\n  var fragmentShader = `\nprecision highp float;\nuniform sampler2D iChannel0, iChannel1, iChannel2, iChannel3;\nuniform vec2 iChannel0Res, iChannel1Res, iChannel2Res, iChannel3Res;\nuniform float iFrame;\nuniform float iTime;\nuniform vec4 iOrientation;\nuniform vec4 iMouse;\nuniform vec3 iTransform;\nuniform vec2 iResolution;\nvarying vec2 v_tex_pos;\n\nvec2 screen2scene(vec2 pos) {\n  pos /= iResolution.xy;\n  float ar = (iResolution.x/iResolution.y);\n  vec2 vt = 2.*(pos - iTransform.xy)/iTransform.z;\n  return vec2(ar*(vt.x - 1.), 1. - vt.y);\n}\n\n${bezier}\n${complexLibrary}\n${main}\n\nvoid main() {\n  float ar = iResolution.x / iResolution.y;\n  gl_FragColor = get_color(vec2(v_tex_pos.x * ar, v_tex_pos.y));\n}\n`;\nreturn fragmentShader;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/shaders/getFragmentCode.js","/**\n * This is work in progress. Mostly loads soundcloud sound stream and makes\n * it accessible via texture to a shared.\n * \n * Read more here: https://github.com/anvaka/pplay#audio-channel\n */\nvar isSoundCloud = require('./isSoundCloud');\nvar loadSoundCloudStream = require('./loadSoundCloudStream');\nvar binHistory = require('./binHistory');\nvar appState = require('../appState');\n\nmodule.exports = audioInput;\n\nfunction audioInput(value, gl, unit) {\n  var fftSize = 1024;\n  var audioTexture;\n  var channelName = 'iChannel' + unit;\n  var resName = channelName + 'Res';\n  var player;\n  var analyser;\n  var frequencyData = new Uint8Array(fftSize);\n\n  var height = 4; // How many rows we have.\n  var width = 512; // 512 frequencies.\n\n  // Two rows, 512 columns each. Each column is a frequency value;\n  // If iFrame is odd, then:\n  //  - first row stores previous frame audio data and\n  //  - second row stores this frame audio data\n  // Otherwise:\n  //  - first row stores this frame audio data\n  //  - second row store last frame data.\n  // \n  // Because frequencies are store as rgba values:\n  //  - r - is current frequency value (range 0..255)\n  //  - g - is avg frequency value (range 0..255)\n  //  - b - is long avg frequency value (range 0..255)\n  //  - a - unused at the moment\n  var audioData;\n  var streamUrl;\n\n  var api = Object.freeze({\n    kind: 'audio',\n    unit,\n    load,\n    dispose,\n    render,\n    initPlayer\n  });\n\n  return api;\n\n  function load() {\n    if (isSoundCloud(value)) {\n      return loadSoundCloudStream(value)\n        .then(url => streamUrl = url)\n        .then(() => {\n          if (appState.hideUI) {\n            // in this mode, there is no vue app to initialize audio. Do it ourselves\n            var player = getOrMakePlayerEl();\n            return initPlayer(player);\n          }\n        });\n    }\n    throw new Error('non soundcloud files are not supported yet.');\n  }\n\n  function initPlayer(playerEl) {\n    player = playerEl;\n    player.crossOrigin = 'anonymous';\n    player.autoplay = true;\n\n    var audioCtx = new (window.AudioContext || window.webkitAudioContext);\n    analyser = audioCtx.createAnalyser();\n    analyser.fftSize = fftSize;\n\n    var source = audioCtx.createMediaElementSource(player);\n    source.connect(analyser);\n    analyser.connect(audioCtx.destination);\n\n    audioData = new Uint8Array(width * height * 4); \n    audioTexture = createTexture(gl.LINEAR, audioData, width, height);\n\n    player.setAttribute('src', streamUrl);\n    player.play();\n    \n    player.removeEventListener('ended', onPlayerEnded);\n    player.addEventListener('ended', onPlayerEnded);\n\n    player.removeEventListener('play', onPlayerStarted);\n    player.addEventListener('play', onPlayerStarted);\n\n    player.removeEventListener('pause', onPlayerEnded);\n    player.addEventListener('pause', onPlayerEnded);\n  }\n\n  function createTexture(filter, data, width, height) {\n    var texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filter);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);\n    if (data instanceof Uint8Array) {\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n    } \n    return texture;\n  }\n\n  function onPlayerEnded() {\n  }\n\n  function onPlayerStarted() {\n  }\n\n  function dispose() {\n    if (audioTexture) {\n      gl.deleteTexture(audioTexture);\n      audioTexture = null;\n      // TODO: Do I need to disconnect?\n    }\n  }\n\n  function render(program, frameNumber) {\n    if (!audioTexture) return;\n\n    analyser.getByteFrequencyData(frequencyData);\n    //for (var i = 0; i < frequencyData.length; ++i) frequencyData[i] = 1;\n    var max = fftSize/2;\n\n    // We are going to alternate between first and second row to\n    // store current/previous frequency data\n    var prevPosition = (frameNumber % 2) * max;\n    var currentPosition = ((frameNumber + 1) % 2) * max;\n\n    for (var i = 0; i < max; ++i) {\n      var ci = (i + currentPosition) * 4;\n      var previ = (i + prevPosition) * 4;\n\n      var immediateValue = frequencyData[i];\n\n      var avgValue = audioData[previ + 1];\n      var longAvg = audioData[previ + 2];\n      audioData[ci] = immediateValue;\n      audioData[ci + 1] = avgValue * 0.5 + immediateValue * 0.5;\n      audioData[ci + 2] = longAvg * 0.9 + immediateValue * 0.1;\n    }\n\n    // TODO: This can be moved into upper array.\n    var prevAgg = prevPosition + 2 * max;\n    var currentAgg = currentPosition + 2 * max;\n    // now perform aggregation\n    for (var i = 0; i < max; i += 2) {\n      var p = (frequencyData[i] + frequencyData[i + 1])/2;\n      var aggOffset = (i/2 + currentAgg) * 4; // aggregation takes only first half\n      var pAggOffset = (i/2 + prevAgg) * 4; \n\n      var aggAvgValue = audioData[pAggOffset + 1];\n      var aggLongAvg = audioData[pAggOffset + 2];\n\n      audioData[aggOffset] = p;\n      audioData[aggOffset + 1] = (aggAvgValue + p) * 0.5;\n      audioData[aggOffset + 2] = aggLongAvg * 0.9 + p * 0.1;\n    }\n\n    // aggregate aggregation. Note, this builds hierarchies of aggregation.\n    // [0..255] - built by previous loop, and contains avg between two source frequencies\n    // [256..256 + 128] - contains average between four source frequencies\n    // [384 .. 384 + 64] - averages between 8 source frequencies, and so on.\n    // The `(last element) - 1` of the array will be an overall average.\n    var halfMax = max/2;\n    for (var i = 0; i < max - 2; i += 2) {\n      var p = (audioData[(i + currentAgg) * 4] + audioData[(i + currentAgg + 1) * 4])*0.5;\n      var aggOffset = (halfMax + i/2 + currentAgg) * 4;\n      var pAggOffset = (halfMax + i/2 + prevAgg) * 4;\n\n      var aggAvgValue = audioData[pAggOffset + 1];\n      var aggLongAvg = audioData[pAggOffset + 2];\n\n      audioData[aggOffset] = p;\n      audioData[aggOffset + 1] = (aggAvgValue + p) * 0.5;\n      audioData[aggOffset + 2] = aggLongAvg * 0.9 + p * 0.1;\n    }\n\n    // We can also compute these in the shader\n    // var immediateRelative = Math.abs(longAvg) < 0.001 ? 1 : immediateValue/longAvg;\n    // var avgRelative = Math.abs(longAvg) < 0.001 ? 1 : avgValue / longAvg;\n\n    gl.activeTexture(gl.TEXTURE0 + unit);\n    gl.bindTexture(gl.TEXTURE_2D, audioTexture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, audioData);\n    gl.uniform1i(program[channelName], unit);\n\n    gl.uniform2f(program[resName], player.currentTime, player.duration);\n  }\n}\n\nfunction getOrMakePlayerEl() {\n  var playerEl = document.querySelector('audio');\n  if (playerEl) return playerEl;\n  playerEl = document.createElement('audio');\n  playerEl.preload = true;\n  playerEl.autobuffer = true;\n  playerEl.constrols = '';\n  // TODO: Better solution?\n  playerEl.style.visibility = 'hidden'\n\n  document.body.appendChild(playerEl);\n  return playerEl;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/channels/audioInput.js","module.exports = loadImage;\n\nfunction loadImage(src) {\n  var resolveImage, rejectImage;\n\n  var image = new Image();\n  image.crossOrigin = '';\n\n  image.onload = imageLoaded;\n  image.onerror = reportError;\n  image.src = src;\n\n  return new Promise((resolve, reject) => {\n    resolveImage = resolve;\n    rejectImage = reject; \n  });\n\n  function reportError(err) { rejectImage(err); }\n  function imageLoaded() { resolveImage(image); }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/loadImage.js","/**\n * XMLHttpRequest wrapped into a promise.\n * \n * @param {String} url \n */\nmodule.exports = function request(url, options) {\n  if (!options) options = {};\n\n  return new Promise(download);\n\n  function download(resolve, reject) {\n    var req = new XMLHttpRequest();\n\n    if (typeof options.progress === 'function') {\n      req.addEventListener('progress', updateProgress, false);\n    }\n\n    req.addEventListener('load', transferComplete, false);\n    req.addEventListener('error', transferFailed, false);\n    req.addEventListener('abort', transferCanceled, false);\n\n    req.open('GET', url);\n    if (options.responseType) {\n      req.responseType = options.responseType;\n    }\n    req.send(null);\n\n    function updateProgress(e) {\n      if (e.lengthComputable) {\n        options.progress({\n          loaded: e.loaded,\n          total: e.total,\n          percent: e.loaded / e.total\n        });\n      }\n    }\n\n    function transferComplete() {\n      if (req.status !== 200) {\n        reject({\n          err: `Unexpected status code ${req.status} when calling ${url}`,\n          response: req.response,\n          status: req.status\n        });\n        return;\n      }\n      var response = req.response;\n\n      if (options.responseType === 'json' && typeof response === 'string') {\n        // IE\n        response = JSON.parse(response);\n      }\n\n      resolve(response);\n    }\n\n    function transferFailed() {\n      reject(`Failed to download ${url}`);\n    }\n\n    function transferCanceled() {\n      reject(`Cancelled download of ${url}`);\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/request.js","// Based on https://github.com/michaelbromley/soundcloud-visualizer\n// Copyright (c) 2013 Michael Bromley <michael@michaelbromley.co.uk>\n// Adopted to pplay needs by Andrei Kashcha. (C) 2018 MIT License\n\n/* global SC */\nmodule.exports = loadSoundCloudStream;\n\nvar client_id = \"oyOHfaO0Xhi6nqwntte71KmwsEQbCmCG\"; // to get an ID go to https://developers.soundcloud.com/\n\nfunction loadSoundCloudStream(track_url) {\n  if (typeof SC === 'undefined') {\n      return new Promise((resolve, reject) => {\n          var scAPI = document.createElement('script');\n          scAPI.setAttribute('src', '//connect.soundcloud.com/sdk.js');\n          scAPI.onload = resolve;\n          scAPI.onerror = reject;\n          document.head.appendChild(scAPI);\n      }).then(() => loadSoundCloudStream(track_url));\n  }\n\n  return new Promise((successCallback, errorCallback) => {\n    SC.initialize({client_id: client_id});\n\n    SC.get('/resolve', { url: track_url }, function(sound) {\n      if (sound.errors) {\n        var errorMessage = \"\";\n        for (var i = 0; i < sound.errors.length; i++) {\n          errorMessage += sound.errors[i].error_message + '.';\n        }\n        errorMessage += 'Make sure the URL has the correct format: https://soundcloud.com/user/title-of-the-track';\n        errorCallback(errorMessage);\n      } else {\n        var streamUrl;\n        if (sound.kind === 'playlist') {\n            var streamPlaylistIndex = 0;\n            streamUrl = sound.tracks[streamPlaylistIndex].stream_url + '?client_id=' + client_id;\n        } else {\n            streamUrl = sound.stream_url + '?client_id=' + client_id; \n        }\n        successCallback(streamUrl);\n      }\n    });\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/channels/loadSoundCloudStream.js","/**\n * This module parses user defined shader code.\n */\n\nvar bus = require('../bus');\nvar pragmaParse = require('./pragmaParser');\nvar getFragmentCode = require('../util/shaders/getFragmentCode');\n\n// This is naive parser that is being used until the real `glsl-parser`\n// is loaded asynchronously. This parser assumes there are no errors\n// TODO: maybe I should be more careful here?\nvar glslParser = {\n  check(code) {\n    return {\n      code,\n      log: {\n        errorCount: 0\n      }\n    };\n  }\n};\n\n// glsl-parser is ~179KB uncompressed, we don't want to wait until it is downloaded.\n// So we load it asynchronously...\nrequire.ensure('glsl-parser', () => {\n  // ... and replace the naive parser with the real one, when ready.\n  glslParser = require('glsl-parser');\n\n  // notify interested parties, so that they can recheck code if they wish.\n  bus.fire('glsl-parser-ready'); \n});\n\n/**\n * Given a string, verifies that it is a valid glsl code,\n * and then returns code + log.\n * \n * @param {String} shaderCode \n */\nmodule.exports = function getParsedShaderFunction(shaderCode) {\n  var libAndCode = getFragmentCode(shaderCode);\n\n  return pragmaParse(libAndCode).then(pragmaParseResult => {\n    if (pragmaParseResult.error) {\n      return pragmaParseResult;\n    }\n\n    var parsedCode = pragmaParseResult.getCode();\n\n    var parserResult = glslParser.check(parsedCode); //{ globals: complexGlobals });\n    parserResult.code = parsedCode;\n    parserResult.main = shaderCode;\n\n    if (parserResult.log.errorCount) parserResult.error = parserError(parserResult.log);\n\n    return parserResult;\n  });\n}\n\nfunction parserError(log) {\n  let diag = log.diagnostics[0];\n  // TODO probably need to check kind (errors are 0, warnings are 1)\n  let firstError = diag.range;\n  let lineColumn = firstError.lineColumn();\n  let source = firstError.source;\n  let offset = source._lineOffsets[lineColumn.line]\n  let line = source.contents.substr(offset,  lineColumn.column);\n  line += source.contents.substring(firstError.start, firstError.end);\n  let prefix = 'Line ' + lineColumn.line + ': ';\n  let diagText = diag.text;\n  return {\n    error: \n      prefix + line + '\\n' +\n      whitespace(prefix.length) + whitespace(lineColumn.column) + '^',\n    errorDetail: diagText,\n    isFloatError: isFloatError(diagText)\n  };\n}\n\nfunction isFloatError(diagText) {\n  return diagText.indexOf('\"int\"') > -1 &&\n    diagText.indexOf('\"float\"')  > -1;\n}\n\nfunction whitespace(length) {\n  return new Array(length + 1).join(' ');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/editor/getParsedShaderFunction.js","module.exports = \"vec4 get_color(vec2 p) {\\n  vec2 z = vec2(0.); float t = 0.;\\n\\n  for(int i = 0; i < 32; ++i) {\\n    if (length(z) > 2.) break;\\n    // main fractal loop. Change it:\\n    z = c_mul(z, z) + p;\\n    t = float(i);\\n  }\\n\\n  return length(z) * vec4(t/64., t/32., t/24., 1.0);\\n}\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/util/shaders/main.glsl\n// module id = NAGP\n// module chunks = 2","var bus = require('../bus');\nvar appState = require('../appState');\nvar getParsedShaderFunction = require('./getParsedShaderFunction');\n\n/**\n * A text editor state for the shader. Manages shader\n * program compilation and error reporting state.\n *\n * @param {Function} updateCode - a callback that is called then code is validated\n * and found to be correct.\n */\nmodule.exports = function createShaderCodeState(updateCode) {\n  bus.on('glsl-parser-ready', parseCode);\n  var currentShaderVersion = 0;\n\n  // What is the current code?\n  var currentShaderCode = appState.getCode();\n\n  // For delayed parsing result verification (e.g. when vue is loaded it\n  // can request us to see if there were any errors)\n  var parserResult;\n\n  loadCodeFromAppState();\n\n  var api = {\n    getCode,\n    setCode,\n    dispose,\n\n    // These properties are for UI only\n    code: currentShaderCode,\n    error: '',\n    errorDetail: '',\n    isFloatError: false \n  };\n\n  return api;\n\n  function dispose() {\n    bus.off('glsl-parser-ready', parseCode);\n  }\n\n  function getCode() {\n    return appState.getCode();\n  }\n\n  function setCode(shaderCode) {\n    if (shaderCode === currentShaderCode) {\n      // If code hasn't changed, let's make sure that there was no previous\n      // error\n      if (parserResult && parserResult.error) {\n        // And if there was error, let's revalidate code:\n        parseCode();\n      }\n      return;\n    } \n\n    trySetNewCode(shaderCode).then((result) => {\n      if (result.cancelled) return;\n\n      if (result && result.error) {\n        updateErrorInfo(result.error);\n        return result;\n      }\n\n      currentShaderCode = shaderCode;\n      api.code = shaderCode;\n      appState.saveCode(shaderCode);\n    });\n  }\n\n  function updateErrorInfo(parserResult) {\n    if (parserResult && parserResult.error) {\n      api.error = parserResult.error;\n      api.errorDetail = parserResult.errorDetail;\n      api.isFloatError = parserResult.isFloatError;\n    } else {\n      api.error = '';\n      api.errorDetail = '';\n      api.isFloatError = false;\n    }\n  }\n\n  function loadCodeFromAppState() {\n    let persistedCode = appState.getCode();\n    if (persistedCode) {\n      trySetNewCode(persistedCode).then(result => {\n        if (!result.error) return; // This means we set correctly;\n        // If we get here - something went wrong. see the console\n        console.error('Failed to restore previous shader code: ', result.error);\n        // Let's use default code\n        trySetNewCode(appState.getDefaultCode());\n      });\n    } else {\n      // we want a default code\n      trySetNewCode(appState.getDefaultCode());\n    }\n  }\n\n  function parseCode(customCode) {\n    return getParsedShaderFunction(customCode || currentShaderCode)\n      .then(currentResult => {\n        parserResult = currentResult\n        updateErrorInfo(parserResult.error);\n        return parserResult;\n      });\n  }\n\n  function trySetNewCode(shaderCode) {\n    currentShaderVersion += 1;\n    var capturedVersion = currentShaderVersion;\n    // step 1 - run through parser\n    return parseCode(shaderCode).then((parserResult) => {\n      if (capturedVersion !== currentShaderVersion) {\n        parserResult.cancelled = true;\n        // a newer request was issued. Ignore these results.\n        return parserResult;\n      }\n\n      if (parserResult.error) {\n        return parserResult;\n      }\n      // step 2 - run through real webgl\n      try {\n        updateCode(parserResult);\n        return parserResult;\n      } catch (e) {\n        return {\n          error: {\n            error: e.message\n          }\n        }\n      }\n    });\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/editor/shaderCodeState.js","\nmodule.exports = isSoundCloud;\n\nfunction isSoundCloud(url) {\n  return url.match(/^https?:\\/\\/soundcloud\\.com\\//);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/channels/isSoundCloud.js","/**\n * This is the main scene. It does not depend on vue application\n * and can be used as long as we have a canvas.\n * \n * Its main responsibility is to manage life cycle of the WebGL app\n */\nvar makePanzoom = require('panzoom');\nvar createShaderCodeState = require('./editor/shaderCodeState');\nvar bus = require('./bus');\nvar util = require('./util/gl-utils');\nvar createShaders = require('./util/createShaders');\nvar createChannelsState = require('./channelsState');\nvar appState = require('./appState');\n\nvar HIDE_UI_THRESHOLD = 2500; // if nothing happens in this many milliseconds - hide ui\n\nmodule.exports = initScene;\n\nfunction initScene(canvas) {\n  var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n  if (!gl) throw new Error('WebGL is not available');\n\n  // This is used to track seconds since application start time.\n  var startTime;\n  // Pass cursor to the shader as `iMouse`\n  var cursor = {currentX: 0, currentY: 0, clickX: 0, clickY: 0};\n  // Pass current frame number to shader as `iFrame`\n  var currentFrameNumber = 0;\n  var orientation = {alpha: 0, beta: 0, gamma: 0, absolute: 0};\n\n  // This will be updated by panzoom controller (see applyTransform)\n  var sceneTransform = {x: 0, y: 0, z: 1};\n  var sceneWidth = canvas.clientWidth;\n  var sceneHeight = canvas.clientHeight;\n\n  // Allow to pan and zoom the scene. The panzoom library\n  // manages user actions, and actual translation happens in the shader.\n  var panzoom = makePanzoom(gl.canvas, {\n    controller: {\n      applyTransform,\n      getOwner() { return gl.canvas; },\n    }\n  });\n\n  restorePanzoom(); // Let's load previous pan zoom state from query string\n\n  // Instead of blindly updating all gl properties, we queue them up\n  // and in the frame renderer we address changes.\n  var requestSizeUpdate = true;      // This means that screen size needs to be updated\n  var requestTransformUpdate = true; // And this means that transforms are dirty\n  var orientationChanged = true;\n\n  // This is used to auto-hide UI when there is no input. We only do this\n  // when code editor is closed, and there was no user activity in HIDE_UI_THRESHOLD ms.\n  // TODO: This can be refactored into vue app. No need for it to be here...\n  var lastActivityTime = new Date();\n\n  // Handle for the next requestAnimationFrame call.\n  var nextAnimationFrame;\n  // Handle of of the interval that \"auto-hides\" UI when app is inactive.\n  var lastActiveIntervalId;\n  \n  // We pass a few things to the shader (like mouse pose), and we need to update\n  // transforms when window changes. So, we listen to relevant events here.\n  listenToEvents();\n\n  var shader = createShaders(appState.getCode());\n\n  gl.enable(gl.BLEND);\n  gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n  gl.clearColor(0, 0, 0, 1); // Not sure if I need this\n  var screenProgram, quadBuffer;\n\n  var channelsState = createChannelsState(gl);\n\n  // This is used by Vue app to communicate with the scene\n  var state = {\n    isActive: true,\n    // This is the main bit for the code. \n    // TODO: If someone wants to use scene independently, this needs to \n    // be less coupled with the application \n    codeEditorState: createShaderCodeState(updateCode),\n    channelsState,\n    goToOrigin,\n    setActivityMonitorEnabled,\n    dispose\n  };\n\n  // This is not very cool, okay?\n  window.scene = state;\n\n  return state; // That's it. The public part is over.\n\n  function animate() {\n    // TODO: Do I need this?\n    gl.clear(gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT);\n    nextAnimationFrame = 0;\n    drawCurrentFrame();\n    currentFrameNumber += 1;\n    scheduleNextFrame();\n  }\n\n  function drawCurrentFrame() {\n    gl.useProgram(screenProgram.program); \n\n    if (requestSizeUpdate) {\n      requestSizeUpdate = false;\n      gl.viewport(0, 0, sceneWidth, sceneHeight);\n      gl.uniform2f(screenProgram.iResolution, sceneWidth, sceneHeight);\n    }\n\n    if (requestTransformUpdate) {\n      requestTransformUpdate = false;\n      gl.uniform3f(screenProgram.iTransform, sceneTransform.x, sceneTransform.y, sceneTransform.z);\n    }\n\n    channelsState.render(screenProgram, currentFrameNumber);\n\n    var iTime = window.performance.now() - startTime;\n    gl.uniform1f(screenProgram.iTime, iTime/1000);\n    gl.uniform1f(screenProgram.iFrame, currentFrameNumber);\n    gl.uniform4f(screenProgram.iMouse, cursor.currentX, cursor.currentY, cursor.clickX, cursor.clickY);\n    if (orientationChanged) {\n      orientationChanged = false;\n      gl.uniform4f(screenProgram.iOrientation, orientation.alpha, orientation.beta, orientation.gamma, orientation.absolute);\n    }\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n  }\n\n  function scheduleNextFrame() {\n    if (nextAnimationFrame) return;\n    nextAnimationFrame = requestAnimationFrame(animate);\n  }\n\n  function updateCode(parserResult) {\n    // We first try to update the program. If there are any errors, this call will throw\n    // and they will be handled by the editor state.\n    var updateProgram = util.createProgram(gl, shader.vertexShader, parserResult.code);\n\n    // If we reach this code, then we didn't throw, and we have a valid webgl code.\n    // Let's unload what we have now.\n    if (screenProgram) screenProgram.unload();\n\n    // And re-initialize all primitives.\n    startTime = window.performance.now();\n    screenProgram = updateProgram;\n\n    quadBuffer = util.createBuffer(gl, new Float32Array([0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1]));\n    util.bindAttribute(gl, quadBuffer, screenProgram.a_pos, 2);\n\n    requestSizeUpdate = true;\n    requestTransformUpdate = true;\n    \n    scheduleNextFrame();\n\n    bus.fire('scene-ready', window.scene);\n  }\n\n  // Technically the following three functions are all related to panzoom\n  // and could be extracted into own module.\n  function goToOrigin() {\n    panzoom.showRectangle({\n      left: 0, right: window.innerWidth,\n      top: 0, bottom: window.innerHeight\n    });\n    \n    applyTransform(panzoom.getTransform());\n  }\n\n  function applyTransform(newTransform) {\n    var tx = newTransform.x/sceneWidth;\n    var ty = newTransform.y/sceneHeight;\n    var scale = newTransform.scale;\n\n    sceneTransform.x = tx;\n    sceneTransform.y = ty; \n    sceneTransform.z = scale;\n    requestTransformUpdate = true;\n    appState.saveTransform(tx, ty, scale);\n    scheduleNextFrame();\n  }\n\n  function restorePanzoom() {\n    var rect = appState.getVisibleRectangle(sceneWidth, sceneHeight);\n    if (rect) panzoom.showRectangle(rect);\n  }\n\n  function markInactiveIfNeeded() {\n    var now = new Date();\n    if (now - lastActivityTime > HIDE_UI_THRESHOLD) state.isActive = false; \n  }\n\n  function setActivityMonitorEnabled(enabled) {\n    if (!enabled) {\n      clearInterval(lastActiveIntervalId);\n      lastActiveIntervalId = false;\n      state.isActive = true;\n    } else if (!lastActiveIntervalId) {\n      lastActiveIntervalId = setInterval(markInactiveIfNeeded, 2000);\n    }\n  }\n\n  function activate() {\n    // This will reset lastActivityTime to now, so that \n    // activity monitor can make correct predictions.\n    lastActivityTime = new Date();\n    state.isActive = true;\n  }\n\n  function dispose() {\n    panzoom.dispose();\n\n    window.removeEventListener('resize', updateSize);\n    window.removeEventListener('mousemove', onMouseMove, true);\n    window.removeEventListener('mousedown', onMouseClick, true);\n    window.removeEventListener('touchstart', onTouchStart, true);\n    window.removeEventListener('touchmove', onTouchMove, true);\n    window.removeEventListener('keydown', activate, true);\n    window.removeEventListener('deviceorientation', onOrientationChange, true);\n\n    cancelAnimationFrame(nextAnimationFrame);\n    setActivityMonitorEnabled(false);\n    nextAnimationFrame = 0;\n  }\n\n  function listenToEvents() {\n    window.addEventListener('resize', updateSize);\n    window.addEventListener('mousemove', onMouseMove, true);\n    window.addEventListener('mousedown', onMouseClick, true);\n    window.addEventListener('touchstart', onTouchStart, true);\n    window.addEventListener('touchmove', onTouchMove, true);\n    window.addEventListener('keydown', activate, true);\n    window.addEventListener('deviceorientation', onOrientationChange, true);\n\n    // We don't want to hide UI if there is no old code.\n    if (appState.hasCode()) setActivityMonitorEnabled(true);\n  }\n\n  function onTouchStart(e) {\n    activate();\n    var firstTouch = e.touches[0];\n    if (!firstTouch) return;\n\n    setClick(firstTouch.clientX, firstTouch.clientY);\n    setHover(firstTouch.clientX, firstTouch.clientY);\n  }\n\n  function onOrientationChange(e) {\n    orientationChanged = true;\n    orientation.absolute = e.absolute;\n    orientation.alpha = Math.PI * e.alpha / 180;\n    orientation.beta = Math.PI * e.beta / 180;\n    orientation.gamma = Math.PI * e.gamma / 180;\n  }\n\n  function onTouchMove(e) {\n    activate();\n    var firstTouch = e.touches[0];\n    if (!firstTouch) return;\n    setHover(firstTouch.clientX, firstTouch.clientY);\n  }\n\n  function onMouseMove(e) { setHover(e.clientX, e.clientY); activate(); }\n\n  function onMouseClick(e) { setClick(e.clientX, e.clientY); activate(); }\n\n  function setHover(ex, ey) {\n    cursor.currentX = ex;\n    cursor.currentY = ey;\n  }\n\n  function setClick(ex, ey) {\n    cursor.clickX = ex;\n    cursor.clickY = ey;\n  }\n\n  function updateSize() {\n    setSceneSize(window.innerWidth, window.innerHeight);\n  }\n\n  function setSceneSize(width, height) {\n    canvas.width = width;\n    canvas.height = height;\n    sceneWidth = width;\n    sceneHeight = height;\n\n    restorePanzoom();\n    requestSizeUpdate = true;\n    scheduleNextFrame();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/scene.js","module.exports = \"// If you are not familiar with bezier easing, see this\\n// http://cubic-bezier.com/#.17,.67,.83,.67\\nvec2 bezier(vec2 p0, vec2 p1, vec2 p2, vec2 p3, float t) {\\n  float one_minus_t = 1. - t;\\n  return one_minus_t * one_minus_t * one_minus_t * p0 + \\n    3. * one_minus_t * one_minus_t * t * p1 + \\n    3. * one_minus_t * t * t * p2 +\\n    t * t * t * p3;\\n}\\n\\n// This one animates t, using control points p1 and p2.\\n// It is very similar to CSS based cubic-bezier timing funciton.\\nfloat bease(float t, vec2 p1, vec2 p2) {\\n  vec2 p0 = vec2(0.);\\n  vec2 p3 = vec2(1.);\\n  vec2 res = bezier(p0, p1, p2, p3, t);\\n  return res.y;\\n}\\n\\n// Produces a uniform value between 0 and 1 over `framesCount` frames\\nfloat timef(float framesCount) {\\n  return mod(iFrame,framesCount)/framesCount;\\n}\\n\\n// Not sure if I want to keep this.\\nfloat bease(float t) {\\n  return bease(t, vec2(0.42, 0), vec2(1));\\n}\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/util/shaders/bezier.glsl\n// module id = Wirq\n// module chunks = 2","var loadImage = require('./util/loadImage');\nvar glUtils = require('./util/gl-utils');\nvar appState = require('./appState');\nvar audioInput = require('./channels/audioInput');\nvar isSoundCloud = require('./channels/isSoundCloud');\n\nmodule.exports = function (gl) {\n  var takenUnits = new Set();\n  var MAX_UNITS_COUNT = 8;\n\n  // TODO: need to have internal list, so that vue does not interfere with performance\n  var viewModels = [];\n  var models = [];\n  var api = {\n    list: viewModels,\n    removeChannel,\n    addChannel,\n    render\n  };\n\n  restoreState();\n\n  return api;\n\n  function restoreState() {\n    var activeChannels = appState.getActiveChannels();\n    if (!activeChannels) return;\n    activeChannels.forEach(channelInfo => {\n      addChannel(channelInfo.src, channelInfo.unit);\n    });\n  }\n\n  function render(program, frameNumber) {\n    for (var i = 0; i < models.length; ++i) {\n      models[i].render(program, frameNumber);\n    }\n  }\n\n  function removeChannel(channel) {\n    if (!takenUnits.has(channel.unit)) throw new Error('You are trying delete something that does not exist');\n\n    var modelIndex = getIndexOfModelWithUnit(models, channel.unit);\n    if (modelIndex === -1) throw new Error('You are trying delete something that does not exist');\n\n    models[modelIndex].dispose();\n    models.splice(modelIndex, 1);\n\n    var viewModelIndex = getIndexOfModelWithUnit(viewModels, channel.unit);\n    viewModels.splice(viewModelIndex, 1);\n    takenUnits.delete(channel.unit);\n    appState.removeChannel(channel.unit);\n\n\n    var hasAudio = false;\n    models.forEach(m => { \n      if (m.kind === 'audio') hasAudio = true;\n    })\n    appState.setSoundIOSWarning(hasAudio);\n  }\n\n  function addChannel(src, unit) {\n    if (typeof src !== 'string') throw new Error('implement me');\n\n    // Client knows where they want to bind. Respect that, unless it's already taken:\n    if (takenUnits.has(unit)) throw new Error('This channel is already taken');\n\n    // if they don't care about the channel - pick first available:\n    if (unit === undefined) unit = getAvailableUnit();\n\n    // If we still don't have it, then...\n    if (unit === undefined) throw new Error('All channels are busy');\n\n    // TODO: I still haven't figured out a lot. This is a mess.\n    // Think of it as if it was a gradient descent to optimal solution, and the code below is step 0.\n    var input;\n    if (isSoundCloud(src)) {\n      input = audioInput(src, gl, unit);\n      appState.setSoundIOSWarning(true);\n    } else if (isImage(src)) {\n      input = imageInput(src, gl, unit);\n    } \n\n    if (!input) throw new Error('not implemented');\n    models.push(input);\n    takenUnits.add(unit);\n\n    var inputViewModel = {\n      kind: input.kind,\n      name: `iChannel${unit}`,\n      unit,\n      error: null,\n      state: 'loading',\n      src: src,\n      model: input\n    };\n    viewModels.push(inputViewModel); \n    input.load().then(() => {\n      inputViewModel.state = 'ready'\n      appState.addChannel(unit, src);\n    }).catch(err => {\n      inputViewModel.state = 'error'\n      inputViewModel.error = err;\n    });\n  }\n\n  function getAvailableUnit() {\n    for (var i = 0; i < MAX_UNITS_COUNT; ++i) {\n      if (!takenUnits.has(i)) return i;\n    }\n  }\n\n  function isImage(/* value */) {\n    // TODO: Implement me.\n    return true;\n  }\n}\n\nfunction imageInput(value, gl, unit) {\n  var needsBinding = true;\n  var texture, width, height;\n  var channelName = 'iChannel' + unit;\n  var resName = channelName + 'Res';\n\n  var api = Object.freeze({\n    kind: 'image',\n    unit,\n    load,\n    dispose,\n    render\n  });\n\n  return api;\n\n  function render(program, frameNumber) {\n    if (!texture) return;\n\n    if (needsBinding) {\n      needsBinding = false;\n    }\n    gl.activeTexture(gl.TEXTURE0 + unit);\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    // TODO: This probably could be optimized. E.g. re-read only when program has changed?\n    gl.uniform1i(program[channelName], unit);\n    gl.uniform2f(program[resName], width, height);\n  }\n\n  function dispose() {\n    if (texture) {\n      gl.deleteTexture(texture);\n      texture = null;\n    } \n  }\n\n  function load() {\n    return loadImage(value).then(image => {\n      texture = glUtils.createTexture(gl, image);\n      width = image.width;\n      height = image.height;\n      return api;\n    });\n  }\n}\n\nfunction getIndexOfModelWithUnit(arr, modelUnit) {\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i].unit === modelUnit) return i;\n  }\n\n  return -1;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/channelsState.js","module.exports = function isSmallScreen() {\n  return window.innerWidth < 600;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/isSmallScreen.js","module.exports = function(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../query-state/node_modules/ngraph.events/index.js\n// module id = fkI9\n// module chunks = 2","var fetchGLSL = require('./fetchGLSL.js');\n\nvar pragmaInclude = '#include ';\nvar defineInclude = '#define ';\nvar nullCode = { code: '' }\n\n/**\n * Naively parses glsl code and tries to replace all `#pragma` statements\n * with empty string. Gives structured collection of pragma statements back\n * \n * @param {String} code \n */\nmodule.exports = function makePragmaParser(code) {\n  if (!code) return new Promise(resolve => resolve(nullCode));\n\n  var parsedLines = processLineByLine(code);\n  if (parsedLines.pending.length > 0) {\n    return Promise.all(parsedLines.pending).then(() => parsedLines)\n      .catch(error => { return {error: {error}}; });\n  }\n\n  return new Promise(resolve => resolve(parsedLines));\n}\n\nfunction processLineByLine(code) {\n  var pending = []\n  var lines = code.split('\\n');\n  var outputLines = [];\n  var currentIndex = 0;\n  var substitutes = new Map();\n\n  lines.forEach((line, index) => {\n    currentIndex = index;\n    if (line && line[0] === '#') {\n      outputLines.push('');\n      processPragma(line);\n    } else {\n      if (substitutes.size > 0) {\n        line = replaceDefines(line);\n      }\n      outputLines.push(line);\n    }\n  });\n\n  return {\n    getCode,\n    pending\n  };\n\n  function getCode() {\n    return outputLines.join('\\n');\n  }\n\n  function processPragma(line) {\n    if (line.indexOf(pragmaInclude) === 0) {\n      var include = line.substr(pragmaInclude.length);\n      var insertIndex = currentIndex;\n      pending.push(fetchGLSL(include).then(code => {\n        outputLines[insertIndex] = code\n      }))\n    } else if (line.indexOf(defineInclude) === 0) {\n      var matches = line.match(/#define\\s+([^\\s].+)\\s+(.+)$/)\n      substitutes.set(matches[1], matches[2]);\n    }\n  }\n\n  function replaceDefines(line) {\n    // Note: this is very fragile, I know. Feel free to improve it.\n    substitutes.forEach((replacement, key) => {\n      line = line.replace(new RegExp(key, 'g'), replacement);\n    });\n    return line;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/editor/pragmaParser.js","var request = require('./request');\n\nmodule.exports = function fetchGist(protoGist) {\n  var parts = protoGist.split('/');\n  return request(`https://api.github.com/gists/${parts[0]}`)\n  .then(res => extractFileContent(res, parts))\n  .catch(err => {\n    if (err && err.response && err.response.match(/rate limit/)) {\n      // Try one more time from cache\n      return request(`https://d2enmttf0dqrei.cloudfront.net/${parts[0]}`)\n        .then(res => extractFileContent(res, parts));\n    }\n  });\n}\n\nfunction extractFileContent(res, parts) {\n  var parsedRes = JSON.parse(res);\n  var fileName = parts.length > 1 && parts[1];\n  if (!fileName) {\n    // pick first file\n    fileName = Object.keys(parsedRes.files).filter(x => x.match(/\\.glsl$/))[0];\n  }\n  var file = parsedRes.files[fileName];\n  if (!file) throw new Error('Missing gist file ' + parts[0] + '/' + fileName);\n\n  return file.content;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/loadGist.js","module.exports = createShaders;\n\nvar getFragmentCode = require('./shaders/getFragmentCode');\n\nfunction createShaders(main) {\n  return {\n    fragmentShader: getFragmentCode(main),\n    vertexShader: `\nprecision highp float;\nattribute vec2 a_pos;\nuniform sampler2D iChannel0, iChannel1, iChannel2, iChannel3;\nuniform vec2 iChannel0Res, iChannel1Res, iChannel2Res, iChannel3Res;\nuniform float iFrame;\nuniform float iTime;\nuniform vec4 iMouse;\nuniform vec2 iResolution;\nuniform vec3 iTransform;\nuniform vec4 iOrientation;\n\nvarying vec2 v_tex_pos;\nvarying vec2 vPos;\n\nvoid main() {\n  vec2 vt = 2.*(a_pos - iTransform.xy)/iTransform.z;\n  v_tex_pos = vec2(vt.x - 1., 1. - vt.y);\n  vec2 vv = vec2(2. * a_pos.x - 1., 1. - 2.*a_pos.y);\n  vPos = a_pos;\n  gl_Position = vec4(vv, 0, 1);\n}    \n`\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/createShaders.js","var loadedLinks = new Map(); // from link to response\nvar request = require('../util/request');\n\nmodule.exports = function fetchGLSL(link) {\n  if (!link) return Promise.reject('Missing link')\n  var trimmed = link.trim();\n  if (!trimmed) return Promise.reject('Missing link');\n\n  let cachedResponse = loadedLinks.get(trimmed)\n  if (cachedResponse) return Promise.resolve(cachedResponse);\n\n  return request(link).then(code => {\n    loadedLinks.set(link, code);\n    return code;\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/editor/fetchGLSL.js","/**\n * This is the main entry point into the application. It initializes\n * scene first, and then asynchronously loads Vue app \n */\nvar initScene = require('./scene');\nvar appState = require('./appState');\nvar bus = require('./bus');\n\nvar canvas = document.getElementById('scene-canvas');\n// Canvas may not be available in test run\nif (canvas) initPixelPlay(canvas);\n\n// Tell webpack to split bundle, and download settings UI later.\nrequire.ensure('@/mainVue.js', () => {\n  // Settings UI is ready, initialize vue.js application\n  require('@/mainVue.js');\n});\n\nfunction initPixelPlay(canvas) {\n  var width = window.innerWidth;\n  var height = window.innerHeight;\n  canvas.width = width;\n  canvas.height =  height;\n  var ctxOptions = {antialias: false};\n\n  var gl = canvas.getContext('webgl', ctxOptions) ||\n          canvas.getContext('experimental-webgl', ctxOptions);\n\n  if (gl) {\n    window.webGLEnabled = true;\n    if (appState.ready) launch();\n    else bus.on('appstate-ready', launch)\n  } else {\n    // The Vue App will notify error later, when loaded.\n    window.webGLEnabled = false;\n  }\n}\n\nfunction launch() {\n  var scene = initScene(canvas);\n  window.scene = scene;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nativeMain.js","/**\n * Very fast moving ratio calculator.\n */\nmodule.exports = createBinHistory;\n\nfunction createBinHistory(historySize) {\n  var min = Number.POSITIVE_INFINITY;\n  var max = Number.NEGATIVE_INFINITY;\n  historySize = historySize || 100;\n  var history = new Uint8Array(historySize);\n  var lastIndex = -1;\n  var needsReindex = true;\n\n  return {\n    addSample,\n    getFrequencyRatio\n  };\n\n  function addSample(value) {\n    lastIndex += 1;\n    if (lastIndex === history.length) {\n      lastIndex = 0;\n    }\n    var replace = history[lastIndex];\n    if (replace === min || replace === max) needsReindex = true;\n    history[lastIndex] = value;\n  }\n\n  function getFrequencyRatio(currentValue) {\n    if (needsReindex) reIndex();\n\n    if (max === min) return 0;\n    return (currentValue - min)/(max - min);\n  }\n\n  function reIndex() {\n    min = Number.POSITIVE_INFINITY;\n    max = Number.NEGATIVE_INFINITY;\n    for (var i = 0; i < historySize; ++i) {\n      var v = history[i];\n      if (v < min) min = v;\n      if (v > max) max = v;\n    }\n    needsReindex = false;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/channels/binHistory.js"],"sourceRoot":""}